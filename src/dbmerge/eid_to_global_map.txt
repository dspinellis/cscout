Values obtained with the rdbu data, which can help understand
the query's functionality.

ec_pairs:
tid|aid
|21
|31
|41
|42
|51
|61
|62
1000|
3000|
3000|31
4000|
4000|41
4000|42
5000|
5000|51
5100|
5100|51
6000|
6000|61
6000|62
6100|
6100|62

filled_ec_pairs:
tid|aid
|21
3000|31
4000|41
4000|42
5000|51
5100|51
6000|61
6000|62
6100|62
1000|

teid_changed_rows:
|21|1
1000||1
3000|31|1
4000|41|1
4000|42|0
4000|45000|0
5000|51|1
5100|51|1
6000|61|1
6000|62|0
6100|62|1
55000|51|1

teid_groups:
|21|1
1000||2
3000|31|3
4000|41|4
4000|42|4
4000|45000|4
5000|51|5
5100|51|6
6000|61|7
6000|62|7
6100|62|8
55000|51|9

aeid_changed_rows:
1000|2||1
|1|21|1
3000|3|31|1
4000|4|41|1
4000|4|42|1
5000|5|51|1
5100|6|51|0
55000|9|51|0
6000|7|61|1
6000|7|62|1
6100|8|62|0
4000|4|45000|1

aeid_groups:
1000|2||11
|1|21|12
3000|3|31|13
4000|4|41|14
4000|4|42|15
5000|5|51|16
5100|6|51|16
55000|9|51|16
6000|7|61|17
6000|7|62|18
6100|8|62|18
4000|4|45000|19

window_values:
aeid|curr_ag|prev_ag|next_ag|teid|curr_tg|prev_tg|next_tg
|11||12|1000|2||1
21|12|11|13||1|2|3
31|13|12|14|3000|3|1|4
41|14|13|15|4000|4|3|4
42|15|14|16|4000|4|4|5
51|16|15|16|5000|5|4|6
51|16|16|16|5100|6|5|9
51|16|16|17|55000|9|6|7
61|17|16|18|6000|7|9|7
62|18|17|18|6000|7|7|8
62|18|18|19|6100|8|7|4
45000|19|18||4000|4|8|

groups_with_nulls:
|1000|2|1
21||1|2
31|3000|3|3
41|4000|4|4
42|4000||5
51|5000|16|6
51|5100||7
51|55000||8
61|6000|7|9
62|6000||10
62|6100||11
45000|4000|4|12


groups:
|1000|2
21||1
31|3000|3
41|4000|4
42|4000|4
51|5000|16
51|5100|16
51|55000|16
61|6000|7
62|6000|7
62|6100|7
45000|4000|4

eid_map:
2|1000|2
2|3000|3
2|4000|4
2|5000|16
2|5100|16
2|55000|16
2|6000|7
2|6100|7
5|21|1
5|31|3
5|41|4
5|42|4
5|51|16
5|61|7
5|62|7
5|45000|4
